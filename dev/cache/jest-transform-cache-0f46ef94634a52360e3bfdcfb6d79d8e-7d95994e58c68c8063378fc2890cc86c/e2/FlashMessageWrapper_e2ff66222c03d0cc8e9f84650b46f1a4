6b0975e926ce08111b50617e79421334
"use strict";

var _interopRequireWildcard = require("@babel/runtime/helpers/interopRequireWildcard");

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.styleWithInset = styleWithInset;
exports.styleWithInsetMargin = styleWithInsetMargin;
exports.default = void 0;

var _classCallCheck2 = _interopRequireDefault(require("@babel/runtime/helpers/classCallCheck"));

var _createClass2 = _interopRequireDefault(require("@babel/runtime/helpers/createClass"));

var _possibleConstructorReturn2 = _interopRequireDefault(require("@babel/runtime/helpers/possibleConstructorReturn"));

var _getPrototypeOf2 = _interopRequireDefault(require("@babel/runtime/helpers/getPrototypeOf"));

var _inherits2 = _interopRequireDefault(require("@babel/runtime/helpers/inherits"));

var _assertThisInitialized2 = _interopRequireDefault(require("@babel/runtime/helpers/assertThisInitialized"));

var _objectSpread2 = _interopRequireDefault(require("@babel/runtime/helpers/objectSpread"));

var _objectWithoutProperties2 = _interopRequireDefault(require("@babel/runtime/helpers/objectWithoutProperties"));

var _react = _interopRequireWildcard(require("react"));

var _reactNative = require("react-native");

var _propTypes = _interopRequireDefault(require("prop-types"));

var X_WIDTH = 375;
var X_HEIGHT = 812;
var PAD_WIDTH = 768;
var PAD_HEIGHT = 1024;

var _Dimensions$get = _reactNative.Dimensions.get("window"),
    D_HEIGHT = _Dimensions$get.height,
    D_WIDTH = _Dimensions$get.width;

var isIPhoneX = function () {
  if (_reactNative.Platform.OS === "web") return false;
  return _reactNative.Platform.OS === "ios" && (D_HEIGHT === X_HEIGHT && D_WIDTH === X_WIDTH || D_HEIGHT === X_WIDTH && D_WIDTH === X_HEIGHT);
}();

var isIPad = function () {
  if (_reactNative.Platform.OS !== "ios" || isIPhoneX) return false;

  if (D_HEIGHT > D_WIDTH && D_WIDTH < PAD_WIDTH) {
    return false;
  }

  if (D_WIDTH > D_HEIGHT && D_HEIGHT < PAD_WIDTH) {
    return false;
  }

  return true;
}();

var isOrientationLandscape = function isOrientationLandscape(_ref) {
  var width = _ref.width,
      height = _ref.height;
  return width > height;
};

var _customStatusBarHeight = null;

var statusBarHeight = function statusBarHeight() {
  var isLandscape = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;

  if (_customStatusBarHeight !== null) {
    return _customStatusBarHeight;
  }

  if (_reactNative.Platform.OS === "android") {
    if (global.Expo) {
      return global.Expo.Constants.statusBarHeight;
    } else {
      return 0;
    }
  }

  if (isIPhoneX) {
    return isLandscape ? 0 : 44;
  }

  if (isIPad) {
    return 20;
  }

  return isLandscape ? 0 : 20;
};

var doubleFromPercentString = function doubleFromPercentString(percent) {
  if (!percent.includes("%")) {
    return 0;
  }

  var dbl = parseFloat(percent) / 100;
  if (isNaN(dbl)) return 0;
  return dbl;
};

function styleWithInset(style, wrapperInset) {
  var hideStatusBar = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;
  var prop = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : "padding";

  if (prop === "margin") {
    return styleWithInsetMargin(style, wrapperInset, hideStatusBar);
  }

  var _Dimensions$get2 = _reactNative.Dimensions.get("window"),
      viewWidth = _Dimensions$get2.width;

  var _StyleSheet$flatten = _reactNative.StyleSheet.flatten(style || {}),
      _StyleSheet$flatten$p = _StyleSheet$flatten.padding,
      padding = _StyleSheet$flatten$p === void 0 ? 0 : _StyleSheet$flatten$p,
      _StyleSheet$flatten$p2 = _StyleSheet$flatten.paddingVertical,
      paddingVertical = _StyleSheet$flatten$p2 === void 0 ? padding : _StyleSheet$flatten$p2,
      _StyleSheet$flatten$p3 = _StyleSheet$flatten.paddingHorizontal,
      paddingHorizontal = _StyleSheet$flatten$p3 === void 0 ? padding : _StyleSheet$flatten$p3,
      _StyleSheet$flatten$p4 = _StyleSheet$flatten.paddingTop,
      paddingTop = _StyleSheet$flatten$p4 === void 0 ? paddingVertical : _StyleSheet$flatten$p4,
      _StyleSheet$flatten$p5 = _StyleSheet$flatten.paddingBottom,
      paddingBottom = _StyleSheet$flatten$p5 === void 0 ? paddingVertical : _StyleSheet$flatten$p5,
      _StyleSheet$flatten$p6 = _StyleSheet$flatten.paddingLeft,
      paddingLeft = _StyleSheet$flatten$p6 === void 0 ? paddingHorizontal : _StyleSheet$flatten$p6,
      _StyleSheet$flatten$p7 = _StyleSheet$flatten.paddingRight,
      paddingRight = _StyleSheet$flatten$p7 === void 0 ? paddingHorizontal : _StyleSheet$flatten$p7,
      viewStyle = (0, _objectWithoutProperties2.default)(_StyleSheet$flatten, ["padding", "paddingVertical", "paddingHorizontal", "paddingTop", "paddingBottom", "paddingLeft", "paddingRight"]);

  if (typeof paddingTop !== "number") {
    paddingTop = doubleFromPercentString(paddingTop) * viewWidth;
  }

  if (typeof paddingBottom !== "number") {
    paddingBottom = doubleFromPercentString(paddingBottom) * viewWidth;
  }

  if (typeof paddingLeft !== "number") {
    paddingLeft = doubleFromPercentString(paddingLeft) * viewWidth;
  }

  if (typeof paddingRight !== "number") {
    paddingRight = doubleFromPercentString(paddingRight) * viewWidth;
  }

  return (0, _objectSpread2.default)({}, viewStyle, {
    paddingTop: !!wrapperInset.isIPhoneX || !hideStatusBar ? paddingTop + wrapperInset.insetTop : paddingTop,
    paddingBottom: paddingBottom + wrapperInset.insetBottom,
    paddingLeft: paddingLeft + wrapperInset.insetLeft,
    paddingRight: paddingRight + wrapperInset.insetRight
  });
}

function styleWithInsetMargin(style, wrapperInset) {
  var hideStatusBar = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;

  var _Dimensions$get3 = _reactNative.Dimensions.get("window"),
      viewWidth = _Dimensions$get3.width;

  var _StyleSheet$flatten2 = _reactNative.StyleSheet.flatten(style || {}),
      _StyleSheet$flatten2$ = _StyleSheet$flatten2.margin,
      margin = _StyleSheet$flatten2$ === void 0 ? 0 : _StyleSheet$flatten2$,
      _StyleSheet$flatten2$2 = _StyleSheet$flatten2.marginVertical,
      marginVertical = _StyleSheet$flatten2$2 === void 0 ? margin : _StyleSheet$flatten2$2,
      _StyleSheet$flatten2$3 = _StyleSheet$flatten2.marginHorizontal,
      marginHorizontal = _StyleSheet$flatten2$3 === void 0 ? margin : _StyleSheet$flatten2$3,
      _StyleSheet$flatten2$4 = _StyleSheet$flatten2.marginTop,
      marginTop = _StyleSheet$flatten2$4 === void 0 ? marginVertical : _StyleSheet$flatten2$4,
      _StyleSheet$flatten2$5 = _StyleSheet$flatten2.marginBottom,
      marginBottom = _StyleSheet$flatten2$5 === void 0 ? marginVertical : _StyleSheet$flatten2$5,
      _StyleSheet$flatten2$6 = _StyleSheet$flatten2.marginLeft,
      marginLeft = _StyleSheet$flatten2$6 === void 0 ? marginHorizontal : _StyleSheet$flatten2$6,
      _StyleSheet$flatten2$7 = _StyleSheet$flatten2.marginRight,
      marginRight = _StyleSheet$flatten2$7 === void 0 ? marginHorizontal : _StyleSheet$flatten2$7,
      viewStyle = (0, _objectWithoutProperties2.default)(_StyleSheet$flatten2, ["margin", "marginVertical", "marginHorizontal", "marginTop", "marginBottom", "marginLeft", "marginRight"]);

  if (typeof marginTop !== "number") {
    marginTop = doubleFromPercentString(marginTop) * viewWidth;
  }

  if (typeof marginBottom !== "number") {
    marginBottom = doubleFromPercentString(marginBottom) * viewWidth;
  }

  if (typeof marginLeft !== "number") {
    marginLeft = doubleFromPercentString(marginLeft) * viewWidth;
  }

  if (typeof marginRight !== "number") {
    marginRight = doubleFromPercentString(marginRight) * viewWidth;
  }

  return (0, _objectSpread2.default)({}, viewStyle, {
    marginTop: !!wrapperInset.isIPhoneX || !hideStatusBar ? marginTop + wrapperInset.insetTop : marginTop,
    marginBottom: marginBottom + wrapperInset.insetBottom,
    marginLeft: marginLeft + wrapperInset.insetLeft,
    marginRight: marginRight + wrapperInset.insetRight
  });
}

var FlashMessageWrapper = function (_Component) {
  (0, _inherits2.default)(FlashMessageWrapper, _Component);

  function FlashMessageWrapper() {
    var _this;

    (0, _classCallCheck2.default)(this, FlashMessageWrapper);
    _this = (0, _possibleConstructorReturn2.default)(this, (0, _getPrototypeOf2.default)(FlashMessageWrapper).call(this));
    _this.handleOrientationChange = _this.handleOrientationChange.bind((0, _assertThisInitialized2.default)((0, _assertThisInitialized2.default)(_this)));
    var isLandscape = isOrientationLandscape(_reactNative.Dimensions.get("window"));
    _this.state = {
      isLandscape: isLandscape
    };
    return _this;
  }

  (0, _createClass2.default)(FlashMessageWrapper, [{
    key: "componentDidMount",
    value: function componentDidMount() {
      _reactNative.Dimensions.addEventListener("change", this.handleOrientationChange);
    }
  }, {
    key: "componentWillUnmount",
    value: function componentWillUnmount() {
      _reactNative.Dimensions.removeEventListener("change", this.handleOrientationChange);
    }
  }, {
    key: "handleOrientationChange",
    value: function handleOrientationChange(_ref2) {
      var window = _ref2.window;
      var isLandscape = isOrientationLandscape(window);
      this.setState({
        isLandscape: isLandscape
      });
    }
  }, {
    key: "render",
    value: function render() {
      var _this$props = this.props,
          position = _this$props.position,
          children = _this$props.children;
      var isLandscape = this.state.isLandscape;

      var _statusBarHeight = statusBarHeight(isLandscape);

      var wrapper = {
        isLandscape: isLandscape,
        isIPhoneX: isIPhoneX,
        isIPad: isIPad,
        statusBarHeight: _statusBarHeight,
        insetTop: position === "top" ? _statusBarHeight : 0,
        insetLeft: (position === "top" || position === "bottom") && isLandscape ? isIPhoneX ? 21 : 0 : 0,
        insetRight: (position === "top" || position === "bottom") && isLandscape ? isIPhoneX ? 21 : 0 : 0,
        insetBottom: isIPhoneX && position === "bottom" ? isLandscape ? 24 : 34 : 0
      };
      return children(wrapper);
    }
  }]);
  return FlashMessageWrapper;
}(_react.Component);

exports.default = FlashMessageWrapper;
FlashMessageWrapper.defaultProps = {
  position: "top"
};
FlashMessageWrapper.propTypes = {
  position: _propTypes.default.string,
  children: _propTypes.default.func.isRequired
};

FlashMessageWrapper.setStatusBarHeight = function (height) {
  _customStatusBarHeight = height;
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkZsYXNoTWVzc2FnZVdyYXBwZXIuanMiXSwibmFtZXMiOlsiWF9XSURUSCIsIlhfSEVJR0hUIiwiUEFEX1dJRFRIIiwiUEFEX0hFSUdIVCIsIkRpbWVuc2lvbnMiLCJnZXQiLCJEX0hFSUdIVCIsImhlaWdodCIsIkRfV0lEVEgiLCJ3aWR0aCIsImlzSVBob25lWCIsIlBsYXRmb3JtIiwiT1MiLCJpc0lQYWQiLCJpc09yaWVudGF0aW9uTGFuZHNjYXBlIiwiX2N1c3RvbVN0YXR1c0JhckhlaWdodCIsInN0YXR1c0JhckhlaWdodCIsImlzTGFuZHNjYXBlIiwiZ2xvYmFsIiwiRXhwbyIsIkNvbnN0YW50cyIsImRvdWJsZUZyb21QZXJjZW50U3RyaW5nIiwicGVyY2VudCIsImluY2x1ZGVzIiwiZGJsIiwicGFyc2VGbG9hdCIsImlzTmFOIiwic3R5bGVXaXRoSW5zZXQiLCJzdHlsZSIsIndyYXBwZXJJbnNldCIsImhpZGVTdGF0dXNCYXIiLCJwcm9wIiwic3R5bGVXaXRoSW5zZXRNYXJnaW4iLCJ2aWV3V2lkdGgiLCJTdHlsZVNoZWV0IiwiZmxhdHRlbiIsInBhZGRpbmciLCJwYWRkaW5nVmVydGljYWwiLCJwYWRkaW5nSG9yaXpvbnRhbCIsInBhZGRpbmdUb3AiLCJwYWRkaW5nQm90dG9tIiwicGFkZGluZ0xlZnQiLCJwYWRkaW5nUmlnaHQiLCJ2aWV3U3R5bGUiLCJpbnNldFRvcCIsImluc2V0Qm90dG9tIiwiaW5zZXRMZWZ0IiwiaW5zZXRSaWdodCIsIm1hcmdpbiIsIm1hcmdpblZlcnRpY2FsIiwibWFyZ2luSG9yaXpvbnRhbCIsIm1hcmdpblRvcCIsIm1hcmdpbkJvdHRvbSIsIm1hcmdpbkxlZnQiLCJtYXJnaW5SaWdodCIsIkZsYXNoTWVzc2FnZVdyYXBwZXIiLCJoYW5kbGVPcmllbnRhdGlvbkNoYW5nZSIsImJpbmQiLCJzdGF0ZSIsImFkZEV2ZW50TGlzdGVuZXIiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwid2luZG93Iiwic2V0U3RhdGUiLCJwcm9wcyIsInBvc2l0aW9uIiwiY2hpbGRyZW4iLCJfc3RhdHVzQmFySGVpZ2h0Iiwid3JhcHBlciIsIkNvbXBvbmVudCIsImRlZmF1bHRQcm9wcyIsInByb3BUeXBlcyIsIlByb3BUeXBlcyIsInN0cmluZyIsImZ1bmMiLCJpc1JlcXVpcmVkIiwic2V0U3RhdHVzQmFySGVpZ2h0Il0sIm1hcHBpbmdzIjoiQUFBQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFFQTs7QUFDQTs7QUFFQTs7QUFPQSxJQUFNQSxPQUFPLEdBQUcsR0FBaEI7QUFDQSxJQUFNQyxRQUFRLEdBQUcsR0FBakI7QUFDQSxJQUFNQyxTQUFTLEdBQUcsR0FBbEI7QUFDQSxJQUFNQyxVQUFVLEdBQUcsSUFBbkI7O3NCQUU2Q0Msd0JBQVdDLEdBQVgsQ0FBZSxRQUFmLEM7SUFBN0JDLFEsbUJBQVJDLE07SUFBeUJDLE8sbUJBQVBDLEs7O0FBRTFCLElBQU1DLFNBQVMsR0FBSSxZQUFNO0FBQ3ZCLE1BQUlDLHNCQUFTQyxFQUFULEtBQWdCLEtBQXBCLEVBQTJCLE9BQU8sS0FBUDtBQUUzQixTQUNFRCxzQkFBU0MsRUFBVCxLQUFnQixLQUFoQixLQUNFTixRQUFRLEtBQUtMLFFBQWIsSUFBeUJPLE9BQU8sS0FBS1IsT0FBdEMsSUFBbURNLFFBQVEsS0FBS04sT0FBYixJQUF3QlEsT0FBTyxLQUFLUCxRQUR4RixDQURGO0FBSUQsQ0FQaUIsRUFBbEI7O0FBU0EsSUFBTVksTUFBTSxHQUFJLFlBQU07QUFDcEIsTUFBSUYsc0JBQVNDLEVBQVQsS0FBZ0IsS0FBaEIsSUFBeUJGLFNBQTdCLEVBQXdDLE9BQU8sS0FBUDs7QUFHeEMsTUFBSUosUUFBUSxHQUFHRSxPQUFYLElBQXNCQSxPQUFPLEdBQUdOLFNBQXBDLEVBQStDO0FBQzdDLFdBQU8sS0FBUDtBQUNEOztBQUdELE1BQUlNLE9BQU8sR0FBR0YsUUFBVixJQUFzQkEsUUFBUSxHQUFHSixTQUFyQyxFQUFnRDtBQUM5QyxXQUFPLEtBQVA7QUFDRDs7QUFFRCxTQUFPLElBQVA7QUFDRCxDQWRjLEVBQWY7O0FBZ0JBLElBQU1ZLHNCQUFzQixHQUFHLFNBQXpCQSxzQkFBeUI7QUFBQSxNQUFHTCxLQUFILFFBQUdBLEtBQUg7QUFBQSxNQUFVRixNQUFWLFFBQVVBLE1BQVY7QUFBQSxTQUF1QkUsS0FBSyxHQUFHRixNQUEvQjtBQUFBLENBQS9COztBQUVBLElBQUlRLHNCQUFzQixHQUFHLElBQTdCOztBQUNBLElBQU1DLGVBQWUsR0FBRyxTQUFsQkEsZUFBa0IsR0FBeUI7QUFBQSxNQUF4QkMsV0FBd0IsdUVBQVYsS0FBVTs7QUFDL0MsTUFBSUYsc0JBQXNCLEtBQUssSUFBL0IsRUFBcUM7QUFDbkMsV0FBT0Esc0JBQVA7QUFDRDs7QUFRRCxNQUFJSixzQkFBU0MsRUFBVCxLQUFnQixTQUFwQixFQUErQjtBQUM3QixRQUFJTSxNQUFNLENBQUNDLElBQVgsRUFBaUI7QUFDZixhQUFPRCxNQUFNLENBQUNDLElBQVAsQ0FBWUMsU0FBWixDQUFzQkosZUFBN0I7QUFDRCxLQUZELE1BRU87QUFDTCxhQUFPLENBQVA7QUFDRDtBQUNGOztBQUVELE1BQUlOLFNBQUosRUFBZTtBQUNiLFdBQU9PLFdBQVcsR0FBRyxDQUFILEdBQU8sRUFBekI7QUFDRDs7QUFFRCxNQUFJSixNQUFKLEVBQVk7QUFDVixXQUFPLEVBQVA7QUFDRDs7QUFFRCxTQUFPSSxXQUFXLEdBQUcsQ0FBSCxHQUFPLEVBQXpCO0FBQ0QsQ0E1QkQ7O0FBOEJBLElBQU1JLHVCQUF1QixHQUFHLFNBQTFCQSx1QkFBMEIsQ0FBQUMsT0FBTyxFQUFJO0FBQ3pDLE1BQUksQ0FBQ0EsT0FBTyxDQUFDQyxRQUFSLENBQWlCLEdBQWpCLENBQUwsRUFBNEI7QUFDMUIsV0FBTyxDQUFQO0FBQ0Q7O0FBRUQsTUFBTUMsR0FBRyxHQUFHQyxVQUFVLENBQUNILE9BQUQsQ0FBVixHQUFzQixHQUFsQztBQUVBLE1BQUlJLEtBQUssQ0FBQ0YsR0FBRCxDQUFULEVBQWdCLE9BQU8sQ0FBUDtBQUVoQixTQUFPQSxHQUFQO0FBQ0QsQ0FWRDs7QUFlTyxTQUFTRyxjQUFULENBQXdCQyxLQUF4QixFQUErQkMsWUFBL0IsRUFBc0Y7QUFBQSxNQUF6Q0MsYUFBeUMsdUVBQXpCLEtBQXlCO0FBQUEsTUFBbEJDLElBQWtCLHVFQUFYLFNBQVc7O0FBQzNGLE1BQUlBLElBQUksS0FBSyxRQUFiLEVBQXVCO0FBQ3JCLFdBQU9DLG9CQUFvQixDQUFDSixLQUFELEVBQVFDLFlBQVIsRUFBc0JDLGFBQXRCLENBQTNCO0FBQ0Q7O0FBSDBGLHlCQUs5RDFCLHdCQUFXQyxHQUFYLENBQWUsUUFBZixDQUw4RDtBQUFBLE1BSzVFNEIsU0FMNEUsb0JBS25GeEIsS0FMbUY7O0FBQUEsNEJBZ0J2RnlCLHdCQUFXQyxPQUFYLENBQW1CUCxLQUFLLElBQUksRUFBNUIsQ0FoQnVGO0FBQUEsa0RBUXpGUSxPQVJ5RjtBQUFBLE1BUXpGQSxPQVJ5RixzQ0FRL0UsQ0FSK0U7QUFBQSxtREFTekZDLGVBVHlGO0FBQUEsTUFTekZBLGVBVHlGLHVDQVN2RUQsT0FUdUU7QUFBQSxtREFVekZFLGlCQVZ5RjtBQUFBLE1BVXpGQSxpQkFWeUYsdUNBVXJFRixPQVZxRTtBQUFBLG1EQVd6RkcsVUFYeUY7QUFBQSxNQVd6RkEsVUFYeUYsdUNBVzVFRixlQVg0RTtBQUFBLG1EQVl6RkcsYUFaeUY7QUFBQSxNQVl6RkEsYUFaeUYsdUNBWXpFSCxlQVp5RTtBQUFBLG1EQWF6RkksV0FieUY7QUFBQSxNQWF6RkEsV0FieUYsdUNBYTNFSCxpQkFiMkU7QUFBQSxtREFjekZJLFlBZHlGO0FBQUEsTUFjekZBLFlBZHlGLHVDQWMxRUosaUJBZDBFO0FBQUEsTUFldEZLLFNBZnNGOztBQWtCM0YsTUFBSSxPQUFPSixVQUFQLEtBQXNCLFFBQTFCLEVBQW9DO0FBQ2xDQSxJQUFBQSxVQUFVLEdBQUdsQix1QkFBdUIsQ0FBQ2tCLFVBQUQsQ0FBdkIsR0FBc0NOLFNBQW5EO0FBQ0Q7O0FBRUQsTUFBSSxPQUFPTyxhQUFQLEtBQXlCLFFBQTdCLEVBQXVDO0FBQ3JDQSxJQUFBQSxhQUFhLEdBQUduQix1QkFBdUIsQ0FBQ21CLGFBQUQsQ0FBdkIsR0FBeUNQLFNBQXpEO0FBQ0Q7O0FBRUQsTUFBSSxPQUFPUSxXQUFQLEtBQXVCLFFBQTNCLEVBQXFDO0FBQ25DQSxJQUFBQSxXQUFXLEdBQUdwQix1QkFBdUIsQ0FBQ29CLFdBQUQsQ0FBdkIsR0FBdUNSLFNBQXJEO0FBQ0Q7O0FBRUQsTUFBSSxPQUFPUyxZQUFQLEtBQXdCLFFBQTVCLEVBQXNDO0FBQ3BDQSxJQUFBQSxZQUFZLEdBQUdyQix1QkFBdUIsQ0FBQ3FCLFlBQUQsQ0FBdkIsR0FBd0NULFNBQXZEO0FBQ0Q7O0FBRUQseUNBQ0tVLFNBREw7QUFFRUosSUFBQUEsVUFBVSxFQUFFLENBQUMsQ0FBQ1YsWUFBWSxDQUFDbkIsU0FBZixJQUE0QixDQUFDb0IsYUFBN0IsR0FBNkNTLFVBQVUsR0FBR1YsWUFBWSxDQUFDZSxRQUF2RSxHQUFrRkwsVUFGaEc7QUFHRUMsSUFBQUEsYUFBYSxFQUFFQSxhQUFhLEdBQUdYLFlBQVksQ0FBQ2dCLFdBSDlDO0FBSUVKLElBQUFBLFdBQVcsRUFBRUEsV0FBVyxHQUFHWixZQUFZLENBQUNpQixTQUoxQztBQUtFSixJQUFBQSxZQUFZLEVBQUVBLFlBQVksR0FBR2IsWUFBWSxDQUFDa0I7QUFMNUM7QUFPRDs7QUFLTSxTQUFTZixvQkFBVCxDQUE4QkosS0FBOUIsRUFBcUNDLFlBQXJDLEVBQTBFO0FBQUEsTUFBdkJDLGFBQXVCLHVFQUFQLEtBQU87O0FBQUEseUJBQ2xEMUIsd0JBQVdDLEdBQVgsQ0FBZSxRQUFmLENBRGtEO0FBQUEsTUFDaEU0QixTQURnRSxvQkFDdkV4QixLQUR1RTs7QUFBQSw2QkFZM0V5Qix3QkFBV0MsT0FBWCxDQUFtQlAsS0FBSyxJQUFJLEVBQTVCLENBWjJFO0FBQUEsbURBSTdFb0IsTUFKNkU7QUFBQSxNQUk3RUEsTUFKNkUsc0NBSXBFLENBSm9FO0FBQUEsb0RBSzdFQyxjQUw2RTtBQUFBLE1BSzdFQSxjQUw2RSx1Q0FLNURELE1BTDREO0FBQUEsb0RBTTdFRSxnQkFONkU7QUFBQSxNQU03RUEsZ0JBTjZFLHVDQU0xREYsTUFOMEQ7QUFBQSxvREFPN0VHLFNBUDZFO0FBQUEsTUFPN0VBLFNBUDZFLHVDQU9qRUYsY0FQaUU7QUFBQSxvREFRN0VHLFlBUjZFO0FBQUEsTUFRN0VBLFlBUjZFLHVDQVE5REgsY0FSOEQ7QUFBQSxvREFTN0VJLFVBVDZFO0FBQUEsTUFTN0VBLFVBVDZFLHVDQVNoRUgsZ0JBVGdFO0FBQUEsb0RBVTdFSSxXQVY2RTtBQUFBLE1BVTdFQSxXQVY2RSx1Q0FVL0RKLGdCQVYrRDtBQUFBLE1BVzFFUCxTQVgwRTs7QUFjL0UsTUFBSSxPQUFPUSxTQUFQLEtBQXFCLFFBQXpCLEVBQW1DO0FBQ2pDQSxJQUFBQSxTQUFTLEdBQUc5Qix1QkFBdUIsQ0FBQzhCLFNBQUQsQ0FBdkIsR0FBcUNsQixTQUFqRDtBQUNEOztBQUVELE1BQUksT0FBT21CLFlBQVAsS0FBd0IsUUFBNUIsRUFBc0M7QUFDcENBLElBQUFBLFlBQVksR0FBRy9CLHVCQUF1QixDQUFDK0IsWUFBRCxDQUF2QixHQUF3Q25CLFNBQXZEO0FBQ0Q7O0FBRUQsTUFBSSxPQUFPb0IsVUFBUCxLQUFzQixRQUExQixFQUFvQztBQUNsQ0EsSUFBQUEsVUFBVSxHQUFHaEMsdUJBQXVCLENBQUNnQyxVQUFELENBQXZCLEdBQXNDcEIsU0FBbkQ7QUFDRDs7QUFFRCxNQUFJLE9BQU9xQixXQUFQLEtBQXVCLFFBQTNCLEVBQXFDO0FBQ25DQSxJQUFBQSxXQUFXLEdBQUdqQyx1QkFBdUIsQ0FBQ2lDLFdBQUQsQ0FBdkIsR0FBdUNyQixTQUFyRDtBQUNEOztBQUVELHlDQUNLVSxTQURMO0FBRUVRLElBQUFBLFNBQVMsRUFBRSxDQUFDLENBQUN0QixZQUFZLENBQUNuQixTQUFmLElBQTRCLENBQUNvQixhQUE3QixHQUE2Q3FCLFNBQVMsR0FBR3RCLFlBQVksQ0FBQ2UsUUFBdEUsR0FBaUZPLFNBRjlGO0FBR0VDLElBQUFBLFlBQVksRUFBRUEsWUFBWSxHQUFHdkIsWUFBWSxDQUFDZ0IsV0FINUM7QUFJRVEsSUFBQUEsVUFBVSxFQUFFQSxVQUFVLEdBQUd4QixZQUFZLENBQUNpQixTQUp4QztBQUtFUSxJQUFBQSxXQUFXLEVBQUVBLFdBQVcsR0FBR3pCLFlBQVksQ0FBQ2tCO0FBTDFDO0FBT0Q7O0lBS29CUSxtQjs7O0FBZW5CLGlDQUFjO0FBQUE7O0FBQUE7QUFDWjtBQUVBLFVBQUtDLHVCQUFMLEdBQStCLE1BQUtBLHVCQUFMLENBQTZCQyxJQUE3QixtRkFBL0I7QUFFQSxRQUFNeEMsV0FBVyxHQUFHSCxzQkFBc0IsQ0FBQ1Ysd0JBQVdDLEdBQVgsQ0FBZSxRQUFmLENBQUQsQ0FBMUM7QUFDQSxVQUFLcUQsS0FBTCxHQUFhO0FBQUV6QyxNQUFBQSxXQUFXLEVBQVhBO0FBQUYsS0FBYjtBQU5ZO0FBT2I7Ozs7d0NBQ21CO0FBQ2xCYiw4QkFBV3VELGdCQUFYLENBQTRCLFFBQTVCLEVBQXNDLEtBQUtILHVCQUEzQztBQUNEOzs7MkNBQ3NCO0FBQ3JCcEQsOEJBQVd3RCxtQkFBWCxDQUErQixRQUEvQixFQUF5QyxLQUFLSix1QkFBOUM7QUFDRDs7O21EQUNtQztBQUFBLFVBQVZLLE1BQVUsU0FBVkEsTUFBVTtBQUNsQyxVQUFNNUMsV0FBVyxHQUFHSCxzQkFBc0IsQ0FBQytDLE1BQUQsQ0FBMUM7QUFDQSxXQUFLQyxRQUFMLENBQWM7QUFBRTdDLFFBQUFBLFdBQVcsRUFBWEE7QUFBRixPQUFkO0FBQ0Q7Ozs2QkFDUTtBQUFBLHdCQUN3QixLQUFLOEMsS0FEN0I7QUFBQSxVQUNDQyxRQURELGVBQ0NBLFFBREQ7QUFBQSxVQUNXQyxRQURYLGVBQ1dBLFFBRFg7QUFBQSxVQUVDaEQsV0FGRCxHQUVpQixLQUFLeUMsS0FGdEIsQ0FFQ3pDLFdBRkQ7O0FBSVAsVUFBTWlELGdCQUFnQixHQUFHbEQsZUFBZSxDQUFDQyxXQUFELENBQXhDOztBQUtBLFVBQU1rRCxPQUFPLEdBQUc7QUFDZGxELFFBQUFBLFdBQVcsRUFBWEEsV0FEYztBQUVkUCxRQUFBQSxTQUFTLEVBQUVBLFNBRkc7QUFHZEcsUUFBQUEsTUFBTSxFQUFFQSxNQUhNO0FBSWRHLFFBQUFBLGVBQWUsRUFBRWtELGdCQUpIO0FBS2R0QixRQUFBQSxRQUFRLEVBQUVvQixRQUFRLEtBQUssS0FBYixHQUFxQkUsZ0JBQXJCLEdBQXdDLENBTHBDO0FBTWRwQixRQUFBQSxTQUFTLEVBQUUsQ0FBQ2tCLFFBQVEsS0FBSyxLQUFiLElBQXNCQSxRQUFRLEtBQUssUUFBcEMsS0FBaUQvQyxXQUFqRCxHQUFnRVAsU0FBUyxHQUFHLEVBQUgsR0FBUSxDQUFqRixHQUFzRixDQU5uRjtBQU9kcUMsUUFBQUEsVUFBVSxFQUFFLENBQUNpQixRQUFRLEtBQUssS0FBYixJQUFzQkEsUUFBUSxLQUFLLFFBQXBDLEtBQWlEL0MsV0FBakQsR0FBZ0VQLFNBQVMsR0FBRyxFQUFILEdBQVEsQ0FBakYsR0FBc0YsQ0FQcEY7QUFRZG1DLFFBQUFBLFdBQVcsRUFBRW5DLFNBQVMsSUFBSXNELFFBQVEsS0FBSyxRQUExQixHQUFzQy9DLFdBQVcsR0FBRyxFQUFILEdBQVEsRUFBekQsR0FBK0Q7QUFSOUQsT0FBaEI7QUFXQSxhQUFPZ0QsUUFBUSxDQUFDRSxPQUFELENBQWY7QUFDRDs7O0VBdEQ4Q0MsZ0I7OztBQUE1QmIsbUIsQ0FDWmMsWSxHQUFlO0FBS3BCTCxFQUFBQSxRQUFRLEVBQUU7QUFMVSxDO0FBREhULG1CLENBUVplLFMsR0FBWTtBQUNqQk4sRUFBQUEsUUFBUSxFQUFFTyxtQkFBVUMsTUFESDtBQUVqQlAsRUFBQUEsUUFBUSxFQUFFTSxtQkFBVUUsSUFBVixDQUFlQztBQUZSLEM7O0FBUkFuQixtQixDQVlab0Isa0IsR0FBcUIsVUFBQXBFLE1BQU0sRUFBSTtBQUNwQ1EsRUFBQUEsc0JBQXNCLEdBQUdSLE1BQXpCO0FBQ0QsQyIsInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xuXG5pbXBvcnQgUmVhY3QsIHsgQ29tcG9uZW50IH0gZnJvbSBcInJlYWN0XCI7XG5pbXBvcnQgeyBEaW1lbnNpb25zLCBQbGF0Zm9ybSwgU3R5bGVTaGVldCB9IGZyb20gXCJyZWFjdC1uYXRpdmVcIjtcblxuaW1wb3J0IFByb3BUeXBlcyBmcm9tIFwicHJvcC10eXBlc1wiO1xuXG4vKipcbiAqIERFVEVDVElPTiBBTkQgRElNRU5TSU9OUyBDT0RFIEZST006XG4gKiBodHRwczovL2dpdGh1Yi5jb20vcmVhY3QtY29tbXVuaXR5L3JlYWN0LW5hdGl2ZS1zYWZlLWFyZWEtdmlld1xuICovXG5cbmNvbnN0IFhfV0lEVEggPSAzNzU7IC8vIGlQaG9uZSBYXG5jb25zdCBYX0hFSUdIVCA9IDgxMjsgLy8gaVBob25lIFhcbmNvbnN0IFBBRF9XSURUSCA9IDc2ODsgLy8gaVBhZFxuY29uc3QgUEFEX0hFSUdIVCA9IDEwMjQ7IC8vIGlQYWRcblxuY29uc3QgeyBoZWlnaHQ6IERfSEVJR0hULCB3aWR0aDogRF9XSURUSCB9ID0gRGltZW5zaW9ucy5nZXQoXCJ3aW5kb3dcIik7XG5cbmNvbnN0IGlzSVBob25lWCA9ICgoKSA9PiB7XG4gIGlmIChQbGF0Zm9ybS5PUyA9PT0gXCJ3ZWJcIikgcmV0dXJuIGZhbHNlO1xuXG4gIHJldHVybiAoXG4gICAgUGxhdGZvcm0uT1MgPT09IFwiaW9zXCIgJiZcbiAgICAoKERfSEVJR0hUID09PSBYX0hFSUdIVCAmJiBEX1dJRFRIID09PSBYX1dJRFRIKSB8fCAoRF9IRUlHSFQgPT09IFhfV0lEVEggJiYgRF9XSURUSCA9PT0gWF9IRUlHSFQpKVxuICApO1xufSkoKTtcblxuY29uc3QgaXNJUGFkID0gKCgpID0+IHtcbiAgaWYgKFBsYXRmb3JtLk9TICE9PSBcImlvc1wiIHx8IGlzSVBob25lWCkgcmV0dXJuIGZhbHNlO1xuXG4gIC8vIGlmIHBvcnRyYWl0IGFuZCB3aWR0aCBpcyBzbWFsbGVyIHRoYW4gaVBhZCB3aWR0aFxuICBpZiAoRF9IRUlHSFQgPiBEX1dJRFRIICYmIERfV0lEVEggPCBQQURfV0lEVEgpIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cblxuICAvLyBpZiBsYW5kc2NhcGUgYW5kIGhlaWdodCBpcyBzbWFsbGVyIHRoYXQgaVBhZCBoZWlnaHRcbiAgaWYgKERfV0lEVEggPiBEX0hFSUdIVCAmJiBEX0hFSUdIVCA8IFBBRF9XSURUSCkge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuXG4gIHJldHVybiB0cnVlO1xufSkoKTtcblxuY29uc3QgaXNPcmllbnRhdGlvbkxhbmRzY2FwZSA9ICh7IHdpZHRoLCBoZWlnaHQgfSkgPT4gd2lkdGggPiBoZWlnaHQ7XG5cbmxldCBfY3VzdG9tU3RhdHVzQmFySGVpZ2h0ID0gbnVsbDtcbmNvbnN0IHN0YXR1c0JhckhlaWdodCA9IChpc0xhbmRzY2FwZSA9IGZhbHNlKSA9PiB7XG4gIGlmIChfY3VzdG9tU3RhdHVzQmFySGVpZ2h0ICE9PSBudWxsKSB7XG4gICAgcmV0dXJuIF9jdXN0b21TdGF0dXNCYXJIZWlnaHQ7XG4gIH1cblxuICAvKipcbiAgICogVGhpcyBpcyBhIHRlbXBvcmFyeSB3b3JrYXJvdW5kIGJlY2F1c2Ugd2UgZG9uJ3QgaGF2ZSBhIHdheSB0byBkZXRlY3RcbiAgICogaWYgdGhlIHN0YXR1cyBiYXIgaXMgdHJhbnNsdWNlbnQgb3Igb3BhcXVlLiBJZiBvcGFxdWUsIHdlIGRvbid0IG5lZWQgdG9cbiAgICogZmFjdG9yIGluIHRoZSBoZWlnaHQgaGVyZTsgaWYgdHJhbnNsdWNlbnQgKGNvbnRlbnQgcmVuZGVycyB1bmRlciBpdCkgdGhlblxuICAgKiB3ZSBkby5cbiAgICovXG4gIGlmIChQbGF0Zm9ybS5PUyA9PT0gXCJhbmRyb2lkXCIpIHtcbiAgICBpZiAoZ2xvYmFsLkV4cG8pIHtcbiAgICAgIHJldHVybiBnbG9iYWwuRXhwby5Db25zdGFudHMuc3RhdHVzQmFySGVpZ2h0O1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gMDtcbiAgICB9XG4gIH1cblxuICBpZiAoaXNJUGhvbmVYKSB7XG4gICAgcmV0dXJuIGlzTGFuZHNjYXBlID8gMCA6IDQ0O1xuICB9XG5cbiAgaWYgKGlzSVBhZCkge1xuICAgIHJldHVybiAyMDtcbiAgfVxuXG4gIHJldHVybiBpc0xhbmRzY2FwZSA/IDAgOiAyMDtcbn07XG5cbmNvbnN0IGRvdWJsZUZyb21QZXJjZW50U3RyaW5nID0gcGVyY2VudCA9PiB7XG4gIGlmICghcGVyY2VudC5pbmNsdWRlcyhcIiVcIikpIHtcbiAgICByZXR1cm4gMDtcbiAgfVxuXG4gIGNvbnN0IGRibCA9IHBhcnNlRmxvYXQocGVyY2VudCkgLyAxMDA7XG5cbiAgaWYgKGlzTmFOKGRibCkpIHJldHVybiAwO1xuXG4gIHJldHVybiBkYmw7XG59O1xuXG4vKipcbiAqIEhlbHBlciBmdW5jdGlvbiB0byBcImFwcGVuZFwiIGV4dHJhIHBhZGRpbmcgaW4gTWVzc2FnZUNvbXBvbmVudCBzdHlsZVxuICovXG5leHBvcnQgZnVuY3Rpb24gc3R5bGVXaXRoSW5zZXQoc3R5bGUsIHdyYXBwZXJJbnNldCwgaGlkZVN0YXR1c0JhciA9IGZhbHNlLCBwcm9wID0gXCJwYWRkaW5nXCIpIHtcbiAgaWYgKHByb3AgPT09IFwibWFyZ2luXCIpIHtcbiAgICByZXR1cm4gc3R5bGVXaXRoSW5zZXRNYXJnaW4oc3R5bGUsIHdyYXBwZXJJbnNldCwgaGlkZVN0YXR1c0Jhcik7XG4gIH1cblxuICBjb25zdCB7IHdpZHRoOiB2aWV3V2lkdGggfSA9IERpbWVuc2lvbnMuZ2V0KFwid2luZG93XCIpO1xuXG4gIGxldCB7XG4gICAgcGFkZGluZyA9IDAsXG4gICAgcGFkZGluZ1ZlcnRpY2FsID0gcGFkZGluZyxcbiAgICBwYWRkaW5nSG9yaXpvbnRhbCA9IHBhZGRpbmcsXG4gICAgcGFkZGluZ1RvcCA9IHBhZGRpbmdWZXJ0aWNhbCxcbiAgICBwYWRkaW5nQm90dG9tID0gcGFkZGluZ1ZlcnRpY2FsLFxuICAgIHBhZGRpbmdMZWZ0ID0gcGFkZGluZ0hvcml6b250YWwsXG4gICAgcGFkZGluZ1JpZ2h0ID0gcGFkZGluZ0hvcml6b250YWwsXG4gICAgLi4udmlld1N0eWxlXG4gIH0gPSBTdHlsZVNoZWV0LmZsYXR0ZW4oc3R5bGUgfHwge30pO1xuXG4gIGlmICh0eXBlb2YgcGFkZGluZ1RvcCAhPT0gXCJudW1iZXJcIikge1xuICAgIHBhZGRpbmdUb3AgPSBkb3VibGVGcm9tUGVyY2VudFN0cmluZyhwYWRkaW5nVG9wKSAqIHZpZXdXaWR0aDtcbiAgfVxuXG4gIGlmICh0eXBlb2YgcGFkZGluZ0JvdHRvbSAhPT0gXCJudW1iZXJcIikge1xuICAgIHBhZGRpbmdCb3R0b20gPSBkb3VibGVGcm9tUGVyY2VudFN0cmluZyhwYWRkaW5nQm90dG9tKSAqIHZpZXdXaWR0aDtcbiAgfVxuXG4gIGlmICh0eXBlb2YgcGFkZGluZ0xlZnQgIT09IFwibnVtYmVyXCIpIHtcbiAgICBwYWRkaW5nTGVmdCA9IGRvdWJsZUZyb21QZXJjZW50U3RyaW5nKHBhZGRpbmdMZWZ0KSAqIHZpZXdXaWR0aDtcbiAgfVxuXG4gIGlmICh0eXBlb2YgcGFkZGluZ1JpZ2h0ICE9PSBcIm51bWJlclwiKSB7XG4gICAgcGFkZGluZ1JpZ2h0ID0gZG91YmxlRnJvbVBlcmNlbnRTdHJpbmcocGFkZGluZ1JpZ2h0KSAqIHZpZXdXaWR0aDtcbiAgfVxuXG4gIHJldHVybiB7XG4gICAgLi4udmlld1N0eWxlLFxuICAgIHBhZGRpbmdUb3A6ICEhd3JhcHBlckluc2V0LmlzSVBob25lWCB8fCAhaGlkZVN0YXR1c0JhciA/IHBhZGRpbmdUb3AgKyB3cmFwcGVySW5zZXQuaW5zZXRUb3AgOiBwYWRkaW5nVG9wLFxuICAgIHBhZGRpbmdCb3R0b206IHBhZGRpbmdCb3R0b20gKyB3cmFwcGVySW5zZXQuaW5zZXRCb3R0b20sXG4gICAgcGFkZGluZ0xlZnQ6IHBhZGRpbmdMZWZ0ICsgd3JhcHBlckluc2V0Lmluc2V0TGVmdCxcbiAgICBwYWRkaW5nUmlnaHQ6IHBhZGRpbmdSaWdodCArIHdyYXBwZXJJbnNldC5pbnNldFJpZ2h0LFxuICB9O1xufVxuXG4vKipcbiAqIEhlbHBlciBmdW5jdGlvbiB0byBcImFwcGVuZFwiIGV4dHJhIG1hcmdpbiBpbiBNZXNzYWdlQ29tcG9uZW50IHN0eWxlXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBzdHlsZVdpdGhJbnNldE1hcmdpbihzdHlsZSwgd3JhcHBlckluc2V0LCBoaWRlU3RhdHVzQmFyID0gZmFsc2UpIHtcbiAgY29uc3QgeyB3aWR0aDogdmlld1dpZHRoIH0gPSBEaW1lbnNpb25zLmdldChcIndpbmRvd1wiKTtcblxuICBsZXQge1xuICAgIG1hcmdpbiA9IDAsXG4gICAgbWFyZ2luVmVydGljYWwgPSBtYXJnaW4sXG4gICAgbWFyZ2luSG9yaXpvbnRhbCA9IG1hcmdpbixcbiAgICBtYXJnaW5Ub3AgPSBtYXJnaW5WZXJ0aWNhbCxcbiAgICBtYXJnaW5Cb3R0b20gPSBtYXJnaW5WZXJ0aWNhbCxcbiAgICBtYXJnaW5MZWZ0ID0gbWFyZ2luSG9yaXpvbnRhbCxcbiAgICBtYXJnaW5SaWdodCA9IG1hcmdpbkhvcml6b250YWwsXG4gICAgLi4udmlld1N0eWxlXG4gIH0gPSBTdHlsZVNoZWV0LmZsYXR0ZW4oc3R5bGUgfHwge30pO1xuXG4gIGlmICh0eXBlb2YgbWFyZ2luVG9wICE9PSBcIm51bWJlclwiKSB7XG4gICAgbWFyZ2luVG9wID0gZG91YmxlRnJvbVBlcmNlbnRTdHJpbmcobWFyZ2luVG9wKSAqIHZpZXdXaWR0aDtcbiAgfVxuXG4gIGlmICh0eXBlb2YgbWFyZ2luQm90dG9tICE9PSBcIm51bWJlclwiKSB7XG4gICAgbWFyZ2luQm90dG9tID0gZG91YmxlRnJvbVBlcmNlbnRTdHJpbmcobWFyZ2luQm90dG9tKSAqIHZpZXdXaWR0aDtcbiAgfVxuXG4gIGlmICh0eXBlb2YgbWFyZ2luTGVmdCAhPT0gXCJudW1iZXJcIikge1xuICAgIG1hcmdpbkxlZnQgPSBkb3VibGVGcm9tUGVyY2VudFN0cmluZyhtYXJnaW5MZWZ0KSAqIHZpZXdXaWR0aDtcbiAgfVxuXG4gIGlmICh0eXBlb2YgbWFyZ2luUmlnaHQgIT09IFwibnVtYmVyXCIpIHtcbiAgICBtYXJnaW5SaWdodCA9IGRvdWJsZUZyb21QZXJjZW50U3RyaW5nKG1hcmdpblJpZ2h0KSAqIHZpZXdXaWR0aDtcbiAgfVxuXG4gIHJldHVybiB7XG4gICAgLi4udmlld1N0eWxlLFxuICAgIG1hcmdpblRvcDogISF3cmFwcGVySW5zZXQuaXNJUGhvbmVYIHx8ICFoaWRlU3RhdHVzQmFyID8gbWFyZ2luVG9wICsgd3JhcHBlckluc2V0Lmluc2V0VG9wIDogbWFyZ2luVG9wLFxuICAgIG1hcmdpbkJvdHRvbTogbWFyZ2luQm90dG9tICsgd3JhcHBlckluc2V0Lmluc2V0Qm90dG9tLFxuICAgIG1hcmdpbkxlZnQ6IG1hcmdpbkxlZnQgKyB3cmFwcGVySW5zZXQuaW5zZXRMZWZ0LFxuICAgIG1hcmdpblJpZ2h0OiBtYXJnaW5SaWdodCArIHdyYXBwZXJJbnNldC5pbnNldFJpZ2h0LFxuICB9O1xufVxuXG4vKipcbiAqIFV0aWxpdHkgY29tcG9uZW50IHdyYXBwZXIgdG8gaGFuZGxlIG9yaWVudGF0aW9uIGNoYW5nZXMgYW5kIGV4dHJhIHBhZGRpbmcgY29udHJvbGUgZm9yIGlPUyAoc3BlY2lhbGx5IGlQYWRzIGFuZCBpUGhvbmUgWClcbiAqL1xuZXhwb3J0IGRlZmF1bHQgY2xhc3MgRmxhc2hNZXNzYWdlV3JhcHBlciBleHRlbmRzIENvbXBvbmVudCB7XG4gIHN0YXRpYyBkZWZhdWx0UHJvcHMgPSB7XG4gICAgLyoqXG4gICAgICogRGVmYXVsdCBGbGFzaE1lc3NhZ2UgcG9zaXRpb24gaXMgXCJ0b3BcIlxuICAgICAqIE90aGVyIG9wdGlvbnMgbGlrZSBcImJvdHRvbVwiIGFuZCBcImNlbnRlclwiIHVzZXMgb3RoZXIgZXh0cmEgcGFkZGluZyBjb25maWd1cmF0aW9uc1xuICAgICAqL1xuICAgIHBvc2l0aW9uOiBcInRvcFwiLFxuICB9O1xuICBzdGF0aWMgcHJvcFR5cGVzID0ge1xuICAgIHBvc2l0aW9uOiBQcm9wVHlwZXMuc3RyaW5nLFxuICAgIGNoaWxkcmVuOiBQcm9wVHlwZXMuZnVuYy5pc1JlcXVpcmVkLFxuICB9O1xuICBzdGF0aWMgc2V0U3RhdHVzQmFySGVpZ2h0ID0gaGVpZ2h0ID0+IHtcbiAgICBfY3VzdG9tU3RhdHVzQmFySGVpZ2h0ID0gaGVpZ2h0O1xuICB9O1xuICBjb25zdHJ1Y3RvcigpIHtcbiAgICBzdXBlcigpO1xuXG4gICAgdGhpcy5oYW5kbGVPcmllbnRhdGlvbkNoYW5nZSA9IHRoaXMuaGFuZGxlT3JpZW50YXRpb25DaGFuZ2UuYmluZCh0aGlzKTtcblxuICAgIGNvbnN0IGlzTGFuZHNjYXBlID0gaXNPcmllbnRhdGlvbkxhbmRzY2FwZShEaW1lbnNpb25zLmdldChcIndpbmRvd1wiKSk7XG4gICAgdGhpcy5zdGF0ZSA9IHsgaXNMYW5kc2NhcGUgfTtcbiAgfVxuICBjb21wb25lbnREaWRNb3VudCgpIHtcbiAgICBEaW1lbnNpb25zLmFkZEV2ZW50TGlzdGVuZXIoXCJjaGFuZ2VcIiwgdGhpcy5oYW5kbGVPcmllbnRhdGlvbkNoYW5nZSk7XG4gIH1cbiAgY29tcG9uZW50V2lsbFVubW91bnQoKSB7XG4gICAgRGltZW5zaW9ucy5yZW1vdmVFdmVudExpc3RlbmVyKFwiY2hhbmdlXCIsIHRoaXMuaGFuZGxlT3JpZW50YXRpb25DaGFuZ2UpO1xuICB9XG4gIGhhbmRsZU9yaWVudGF0aW9uQ2hhbmdlKHsgd2luZG93IH0pIHtcbiAgICBjb25zdCBpc0xhbmRzY2FwZSA9IGlzT3JpZW50YXRpb25MYW5kc2NhcGUod2luZG93KTtcbiAgICB0aGlzLnNldFN0YXRlKHsgaXNMYW5kc2NhcGUgfSk7XG4gIH1cbiAgcmVuZGVyKCkge1xuICAgIGNvbnN0IHsgcG9zaXRpb24sIGNoaWxkcmVuIH0gPSB0aGlzLnByb3BzO1xuICAgIGNvbnN0IHsgaXNMYW5kc2NhcGUgfSA9IHRoaXMuc3RhdGU7XG5cbiAgICBjb25zdCBfc3RhdHVzQmFySGVpZ2h0ID0gc3RhdHVzQmFySGVpZ2h0KGlzTGFuZHNjYXBlKTtcblxuICAgIC8qKlxuICAgICAqIFRoaXMgd3JhcHBlciB3aWxsIHJldHVybiBkYXRhIGFib3V0IGV4dHJhIGluc2V0IHBhZGRpbmcsIHN0YXR1c0JhckhlaWdodCBhbmQgc29tZSBkZXZpY2UgZGV0ZWN0aW9uIGxpa2UgaVBob25lWCBhbmQgaVBhZFxuICAgICAqL1xuICAgIGNvbnN0IHdyYXBwZXIgPSB7XG4gICAgICBpc0xhbmRzY2FwZSxcbiAgICAgIGlzSVBob25lWDogaXNJUGhvbmVYLFxuICAgICAgaXNJUGFkOiBpc0lQYWQsXG4gICAgICBzdGF0dXNCYXJIZWlnaHQ6IF9zdGF0dXNCYXJIZWlnaHQsXG4gICAgICBpbnNldFRvcDogcG9zaXRpb24gPT09IFwidG9wXCIgPyBfc3RhdHVzQmFySGVpZ2h0IDogMCxcbiAgICAgIGluc2V0TGVmdDogKHBvc2l0aW9uID09PSBcInRvcFwiIHx8IHBvc2l0aW9uID09PSBcImJvdHRvbVwiKSAmJiBpc0xhbmRzY2FwZSA/IChpc0lQaG9uZVggPyAyMSA6IDApIDogMCxcbiAgICAgIGluc2V0UmlnaHQ6IChwb3NpdGlvbiA9PT0gXCJ0b3BcIiB8fCBwb3NpdGlvbiA9PT0gXCJib3R0b21cIikgJiYgaXNMYW5kc2NhcGUgPyAoaXNJUGhvbmVYID8gMjEgOiAwKSA6IDAsXG4gICAgICBpbnNldEJvdHRvbTogaXNJUGhvbmVYICYmIHBvc2l0aW9uID09PSBcImJvdHRvbVwiID8gKGlzTGFuZHNjYXBlID8gMjQgOiAzNCkgOiAwLFxuICAgIH07XG5cbiAgICByZXR1cm4gY2hpbGRyZW4od3JhcHBlcik7XG4gIH1cbn1cbiJdfQ==